// This is your Prisma schema file,
// learn more about it in the docs: https://pris.ly/d/prisma-schema

// Looking for ways to speed up your queries, or scale easily with your serverless or edge functions?
// Try Prisma Accelerate: https://pris.ly/cli/accelerate-init

generator client {
    provider            = "prisma-client"
    output              = "../generated/prisma"
}

datasource db {
    provider            = "postgresql"
    url                 = env("DATABASE_URL")
    shadowDatabaseUrl   = env("SHADOW_DATABASE_URL")
}

model Feedback {
    id              Int             @id @default(autoincrement())
    type            FeedbackType
    authorId        String
    message         String
    createdAt       DateTime        @default(now())

    @@index([type, authorId, createdAt])
}

enum FeedbackType {
    BUG
    FEATURE
    GENERAL
}

model Quote {
    id              Int             @id @default(autoincrement())
    token           String
    creatorId       String
    context         String?
    createdAt       DateTime        @default(now())

    statements      QuoteStatement[]

    @@index([token, creatorId, createdAt])
}

model QuoteStatement {
    id              Int             @id @default(autoincrement())
    quoteId         Int
    quote           Quote           @relation(fields: [quoteId], references: [id], onDelete: Cascade)
    text            String
    authorId        String
    order           Int // Position of quote in conversation

    @@index([quoteId, authorId, order])
}
